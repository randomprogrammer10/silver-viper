<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <style type="text/css">
        /* Style Charts Here */
        .axis {
            font-family: sans-serif;
            fill: #d35400;
            font-size: 12px;
        }

        .line {
            fill: none;
            stroke: #f1c40f;
            stroke-width: 3px;
        }

        .smoothline {
            fill: none;
            stroke: #e74c3c;
            stroke-width: 3px;
        }

        .circle {
            stroke: #e74c3c;
            stroke-width: 3px;
            fill: #FFF;
        }

        .grid {
            stroke: #DDD;
            stroke-width: 1px;
            fill: none;
        }
    </style>
</head>

<body>
    <svg id="chart"></svg>

    <script src="js-libs/d3/d3.min.js"></script>
    <script>
        var data = [];
        var margin = { top: 20, right: 20, bottom: 30, left: 20 }
        var width = window.innerWidth - margin.left - margin.right;
        var height = window.innerHeight - margin.top - margin.bottom;
        var globalX = 0;
        var duration = width;
        var max = width;
        var step = 20;
        var chart = d3.select('#chart')
            .attr('width', width + 50)
            .attr('height', height + 50);
        var x = d3.scaleLinear().domain([0, width]).range([0, width]);
        var y = d3.scaleLinear().domain([0, width]).range([height, 0]);
        // -----------------------------------
        var line = d3.line()
            .x(function (d) { return x(d.x); })
            .y(function (d) { return y(d.y); });
        var smoothLine = d3.line().curve(d3.curveCardinal)
            .x(function (d) { return x(d.x); })
            .y(function (d) { return y(d.y); });
        // -----------------------------------

        // Draw the axis
        var xAxis = d3.axisBottom().scale(x);
        var axisX = chart.append('g').attr('class', 'x axis')
            .attr('transform', 'translate(0, '+ height +')')
            .call(xAxis);
            
        // Append the holder for line chart and fill area
        var path = chart.append('path');

        // Main loop
        function tick() {
            // Generate new data
            var point = {
                x: globalX,
                y: ((Math.random() * height + 50) >> 0)
            };
            data.push(point);
            globalX += step;

            // Draw new line
            path.datum(data)
                .attr('class', 'smoothline')
                .attr('d', smoothLine);

            // Shift the chart left
            x.domain([globalX - (max - step), globalX]);
            axisX.transition()
                .duration(duration)
                .ease(d3.easeLinear, 2)
                .call(xAxis);

            path.attr('transform', null)
                .transition()
                .duration(duration)
                .ease(d3.easeLinear, 2)
                .attr('transform', 'translate(' + x(globalX - max) + ')')
                .on('end', tick)
            // Remote old data (max 50 points)
            if (data.length > width) data.shift();
        }
        tick();

    </script>
</body>
</html>